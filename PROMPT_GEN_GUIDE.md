# 🚀 Prompt Gen → Image 快速使用指南

## 📖 基础用法

### 标准工作流（推荐）

```
┌────────┐    ┌────────────┐    ┌───────┐    ┌───────┐
│ Prompt │───▶│ Prompt Gen │───▶│ Image │───▶│ Debug │
└────────┘    └────────────┘    └───────┘    └───────┘
  输入描述       生成提示词        生成图片      查看结果
```

### 步骤说明

1. **创建 Prompt 节点**
   - 输入你想要的图片描述，例如：`"一只可爱的猫"`
   
2. **创建 Prompt Gen 节点**
   - 将 Prompt 节点连接到 Prompt Gen
   - Prompt Gen 会生成专业的 JSON 格式提示词：
     ```json
     {
       "prompt": "一只可爱的橘色小猫，毛茸茸的，大眼睛，坐在温暖的阳光下，高清照片，专业摄影",
       "negative_prompt": "模糊，低质量，变形，多余的肢体，文字，水印，签名"
     }
     ```

3. **创建 Image 节点**
   - 将 Prompt Gen 连接到 Image
   - **重要：两个输入框都留空**（让系统自动填充）
   - 选择模型和尺寸

4. **运行工作流**
   - 点击 `▶ 运行` 按钮
   - 等待执行完成
   - 在 Image 节点查看生成的图片

5. **查看参数传递**（可选）
   - Image 节点会显示 `🔗 参数传递 (2)`
   - 点击展开，查看正向和负向提示词的传递详情

## 🎨 高级用法

### 场景 1：微调正向提示词

如果你想**自己控制**正向提示词，但保留负向提示词：

```
1. Image 节点 Prompt 字段填入：
   "一只威武的老虎，站在山巅，夕阳背景"
   
2. Image 节点 Negative Prompt 字段留空

结果：
  - Prompt 使用你的输入 ✍️
  - Negative Prompt 使用 Prompt Gen 生成的 📋
```

### 场景 2：完全自定义

如果你想**完全控制**两个字段：

```
1. Image 节点 Prompt 字段填入：
   "你的正向提示词"
   
2. Image 节点 Negative Prompt 字段填入：
   "你的负向提示词"

结果：
  - 两个字段都使用你的输入 ✍️
  - Prompt Gen 的输出被忽略
```

### 场景 3：调试查看

如果你想**详细查看**每一步的输入输出：

```
1. 点击 TopBar 的 🐛 调试 按钮

2. 点击 ▶ 运行

3. Prompt Gen 执行后会自动暂停
   - 双击 Prompt Gen 查看生成的 JSON
   
4. 点击 ⏭ 下一步 继续

5. Image 节点执行
   - 查看参数传递面板，确认数据正确
   - 双击 Image 节点查看最终使用的参数
   
6. 点击 ⏭ 下一步 完成
```

## 🔍 参数传递面板详解

当 Prompt Gen 连接到 Image 时，Image 节点会显示：

```
🔗 参数传递 (2) ▼
```

点击展开后：

```
┌─────────────────────────────────────────────────────┐
│ 映射 1                                              │
│ [Prompt Gen] → [✨ Prompt (正向提示词)]            │
│ 📋 从 JSON 对象自动提取                            │
│                                                     │
│ 上游输出:                                          │
│ 一只可爱的橘色小猫，毛茸茸的，大眼睛，坐在温暖的│
│ 阳光下，高清照片，专业摄影，细节丰富...          │
│                                                     │
│ ✓ 已传递                                           │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│ 映射 2                                              │
│ [Prompt Gen] → [🚫 Negative Prompt (负向提示词)]  │
│ 📋 从 JSON 对象自动提取                            │
│                                                     │
│ 上游输出:                                          │
│ 模糊，低质量，变形，多余的肢体，文字，水印，签名，│
│ 低分辨率，噪点，颗粒感...                         │
│                                                     │
│ ✓ 已传递                                           │
└─────────────────────────────────────────────────────┘
```

### 图标说明

| 图标 | 含义 | 说明 |
|-----|------|------|
| 📋 | 自动提取 | 从 Prompt Gen 的 JSON 对象自动提取 |
| ✍️ | 手动输入 | 你手动输入的内容优先使用 |
| ✓ 已传递 | 绿色勾号 | 数据已成功传递 |
| ⏳ 待执行 | 沙漏 | 节点还未执行 |

## 💡 最佳实践

### ✅ 推荐做法

1. **让系统自动工作**
   - Image 节点的两个字段都留空
   - 让 Prompt Gen 生成专业的提示词
   - 这是最简单、最有效的方式

2. **使用调试模式学习**
   - 开启调试模式查看 Prompt Gen 的输出
   - 了解什么样的提示词效果好
   - 可以复制好的提示词模板

3. **善用参数传递面板**
   - 展开查看详细的数据流向
   - 确认参数是否正确传递
   - 排查问题时的第一选择

### ❌ 不推荐做法

1. **不要在 Image 节点写模板引用**
   - ❌ 不要写 `{{node_xxx}}`
   - ❌ 系统会自动处理，无需手动引用
   - ✅ 直接留空或写实际文本

2. **不要同时手动输入又期望自动**
   - ❌ 如果你手动输入了，就不会使用上游值
   - ✅ 要么全自动，要么全手动，不要混淆

3. **不要忽略负向提示词**
   - ❌ 负向提示词很重要，能大幅提升图片质量
   - ✅ 如果你不知道写什么，就让 Prompt Gen 自动生成

## 🐛 常见问题

### Q1: 为什么参数传递面板不显示？

**A:** 可能原因：
- Prompt Gen 节点还未执行
- 节点没有正确连接
- 刷新页面后重新运行

### Q2: 为什么显示 "[object Object]"？

**A:** 这是旧版本的 bug，已修复。请确保：
- Docker 镜像已更新（运行 `docker compose build`）
- 服务已重启（运行 `docker compose up -d`）
- 浏览器已刷新（Ctrl/Cmd + Shift + R 强制刷新）

### Q3: 为什么手动输入不生效？

**A:** 检查：
- 输入的内容前后是否有多余空格（trim 后为空）
- 是否包含了 `{{}}` 模板语法（会被认为是引用）
- 清空字段重新输入

### Q4: 生成的图片质量不好？

**A:** 尝试：
- 让 Prompt 节点的描述更详细
- 查看 Prompt Gen 生成的提示词是否符合预期
- 在 Image 节点选择更高级的模型
- 调整图片尺寸

## 📊 工作流示例

### 示例 1：生成动物照片

```
Prompt: "一只在草地上奔跑的金毛狗"
         ↓
Prompt Gen: 生成专业提示词
         ↓
Image: 自动接收并生成图片
         ↓
结果: 高质量的金毛狗照片
```

### 示例 2：生成艺术作品

```
Prompt: "梵高风格的星空画"
         ↓
Prompt Gen: 添加艺术风格细节
         ↓
Image: 生成梵高风格图片
         ↓
结果: 艺术感十足的星空画
```

### 示例 3：生成人物肖像

```
Prompt: "一位优雅的女士，穿着晚礼服"
         ↓
Prompt Gen: 添加细节和光影描述
         ↓
Image: 生成人物肖像
         ↓
结果: 专业级人物照片
```

## 🎓 学习路径

### 初学者
1. 创建简单的三节点工作流（Prompt → Prompt Gen → Image）
2. 尝试不同的描述，观察效果
3. 学习查看参数传递面板

### 进阶用户
1. 尝试手动微调提示词
2. 使用调试模式理解数据流向
3. 创建复杂的多节点工作流

### 高级用户
1. 创建自己的提示词模板库
2. 组合多个 AI 节点（Vision、Filter 等）
3. 批量生成图片

## 📚 相关文档

- `PROMPT_GEN_SUMMARY.md` - 技术总结和原理说明
- `PROMPT_GEN_FIX.md` - 详细的实现方案和代码分析
- `PROMPT_GEN_TEST.md` - 完整的测试清单
- `DEBUG_FEATURES.md` - 调试功能使用指南
- `README.md` - 项目主文档

## 🚀 快速上手

**最简单的开始：**

1. 打开 http://localhost:8000
2. 创建 Prompt 节点，输入 `"一只猫"`
3. 创建 Prompt Gen 节点，连接上一步
4. 创建 Image 节点，连接上一步（两个字段留空）
5. 点击 `▶ 运行`
6. 等待几秒钟，查看生成的猫咪图片 🐱

就是这么简单！

---

**文档版本：** v1.0  
**最后更新：** 2026-01-09  
**适用版本：** QwenFlow v1.0+  

✨ 享受你的创作之旅！